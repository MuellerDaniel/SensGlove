
\lhead[\chaptername~\thechapter]{\rightmark}

\rhead[\leftmark]{}

\lfoot[\thepage]{}

\cfoot{}

\rfoot[]{\thepage}


\chapter{Foundations}
\label{cha:foundations}

\section{Anatomy of the human hand} \label{sec:anatomy}
The anatomy and the motion of the human hand is very complex. Describing the whole interaction of tendons, muscles and bones would go beyond the scope of this thesis. This section will focus on the kinematic structure of the hand, concentrating on the bones and knuckles which are the most relevant parts for describing the range of possible motions. The goal is to understand and derive a model to reliably reconstruct the human hand motion.\\
Bullock et al. \cite{bullock2012assessing} and Lin et al. \cite{lin2000modeling} serve as a good and application oriented introduction to the anatomic structure. A CT scanned image of the hand with explanations is provided by \ref{fig:skeletHand}. The metacarpals are enclosed by muscles and tendons and form the palm. This section is in principle very static and only small ranges of flexion/extension is possible. During strong motions, like grasping, the metacarpals can move slightly, such that a maximum flexion-extension of \SI{20}{\degree} around the \ac{CMC} joints is possible. However this movement is not very natural and common, the skeletal palm is assumed to be fixed. From that it directly follows that also the positions of the \ac{MCP} joints lie in the same plane and their positions are also static. A static joint position means, that the center of rotation stays the same. Anatomically seen this is again a simplification, since the joint axes are only fixed within \SI{1.5}{mm} during a full flexion/extension of the \ac{MCP}. Each \ac{MCP} has two degrees of freedom, since abduction/adduction is possible within a range of around \SI{30}{\degree} and flexion/extension of approximately \SI{90}{\degree} is possible. Strictly speaking one also has to consider axial rotation of the MCP, but since this small amount of movement can only be performed by applying external forces it is neglected here. Next to the MCP comes the proximal phalanges with the \ac{PIP} joint, the intermediate phalanges with the \ac{DIP} joint and the distal phalanges. The \ac{PIP} and \ac{DIP} joints show one degree of freedom each, since only flexion/extension is possible here. The maximum range of movement for the \ac{PIP} will be assumed as \SI{90}{\degree} and for the \ac{DIP} as \SI{110}{\degree}. One could assume that the three bones (proximal, intermediate and distal phalanges) representing a finger move in one plane, relative to the first joint (\ac{MCP}). In other words, that the flexion/extension axes of the three joints (\ac{MCP},\ac{PIP} and \ac{DIP}) are all parallel to each other. From an anatomical view, this is not totally right, but since this shift is only small it is neglected by most groups. So in total one finger comes with 4 \ac{DOF}. Lin et al. propose to introduce an intra-finger constraint, concerning the movement of the \ac{PIP} and \ac{DIP} joints. In order to bend the \ac{DIP} joint, the \ac{PIP} must also be bended. The relation between those two joints is commonly approximated as $ \theta_{DIP} = \frac{2}{3} \theta_{PIP} $. This reduces the overall \ac{DOF} for one finger to three. The thumb was not described till now. This special finger of the human hand, being the most important for powerful and helpful interactions induces even more complexity. It's flexibility allows reaching and touching the other fingertips. Like the others it has three joints, however comprising more \ac{DOF}. The \ac{MCP} has two \ac{DOF} as well as the \acs{TM}. In total the thumb has therefore five \ac{DOF}. To obtain an easier model, the movement of the thumb is neglected.


\begin{figure}[h]
\centering
	\subfloat[Bone structure of the right hand.]
	{\includegraphics[width=0.5\textwidth]{pictures/boneHand.png}\label{fig:boneHand}}
	\hfill
	\subfloat[Joints of the right hand.]
	{\includegraphics[width=0.5\textwidth]{pictures/jointsHand.png}\label{fig:jointsHand}}
\caption{Skeletal representation for the bones and joints of the right human hand. Dorsal view \cite{bullock2012assessing}}
\label{fig:skeletHand}
\end{figure}

The following list summarizes the proposed assumptions and simplifications, applied to the model:
\begin{itemize}
\item Only movements without applying external forces are modeled.
\item Joints are modeled as a combination of ideal revolute joints
\item Bones serve as perfect rigid bodies.
\item So the fingers can be modeled as a kinematic chain.
\item The movement of the thumb is neglected for simplicity reasons.
\item The flexion/extension of metacarpals is neglected, this means the palm is assumed as a rigid plane which comprises the fixed positions of the \acp{MCP}.
\item The flexion/extension of one finger is planar
\item \ac{MCP} has 2 \ac{DOF} with flexion/extension angle: $ \ang{0} \leq \theta_{MCP} \leq \ang{90} $ and adduction/abduction angle: $ \ang{0} \leq \psi_{MCP} \leq \ang{90} $
\item \ac{DIP} and \ac{PIP} have 1 DOF with flexion/extension angle: $ \ang{0} \leq \theta_{PIP} \leq \ang{90} $ and $ \ang{0} \leq \theta_{DIP} \leq \ang{110} $
\item Dynamic constraint between $ \theta_{DIP} = \frac{2}{3} \theta_{PIP} $
\item So each finger has 3 \ac{DOF} in total.
\item A local frame is used for motion reconstruction, so one can represent a pose by describing the joint angles.
\end{itemize}

The introduced assumptions try to restrict the human hand in a useful meaning, without loosing generality. There can even be introduced inter-finger constraints, due to naturalness of hand motions. For example that one can not totally bend the index finger without also bending the others. However each hand is different, implying the range and ability of finger poses, so this behavior is very difficult to generalize and to model.\\
The application specific restrictions applied to the model are further depicted in \todo{add section reference!}




\section{Magnetic} \label{sec:magneticFound}
Permanent magnets are widely used nowadays. Their constant magnetic characteristics are used in electric engines, computer tomography or by interacting with other ferro-, para- or diamagnetic materials, in the simplest case for holding things at a dedicated place. The principle behind it is the excitation of a magnetic field. It is commonly known that only magnetic dipoles exist, meaning that a magnetic north pole never comes without its respective south pole. The shape of the magnetic field lines is commonly known and part of undergraduate physics. However when it comes to the physical description of the magnetic field lines of a permanent magnet, the subject gets more complex. In the following a mathematical approximation for describing the magnetic field, excited by a permanent cylindrical neodymium bar magnet of length $ 2b $ and radius $ a $ will be presented. The strength of the magnetic field, or in other words the magnetic flux density is denoted by $ \mathrm{B} $, its corresponding SI-Unit is called Tesla ($ \SI{1}{\tesla} = 1 \si[per-mode=fraction]{\kilogram \per \ampere \per \second \squared} $). However there exists another unit to describe this strength, called Gauss, which is used by the CGS-system($ 1 \mathrm{Gs} = 10^{-4}\SI{}{\tesla} $). \\
At first one has to mention that a current carrying loop also excites a magnetic field. This is described among others by the Biot-Savart law. The law is valid for the approximation of static magnetic fields. The representation as magnetic dipole by a single current loop or a pair of contrary poles, and the description of its field lines is the base for the ongoing derivation and a common method \cite{derby2010cylindrical}. Accordingly the literature often treats the magnetic field as excited by electric current. The electromagnetic equivalent to a cylindrical bar magnet would be a tightly wound solenoid with a number of turns per unit length $ n $ carrying a current $ I $.\\
A very easy and rough approximation for describing the magnetic field of a permanent magnet can be done by describing it as a magnet dipole. This approximation is used by Ma et al. \cite{ma2010magnetic}. As briefly mentioned beforehand there are only magnetic dipoles, represented by a pair consisting of a (positive) north pole and a (negative) south pole. The field lines are oriented along the direction of the magnetic dipole moment $ \vec{m} $ and go from north to south (see \ref{fig:magDipole}). %\todo{(see \ref{fig:magDipole)}.
\begin{figure}
\centering
\label{fig:magDipole}
\includegraphics[width=0.3\textwidth]{pictures/magDipole.jpg}
\caption{The shape of the magnetic field lines, excited by a magnetic dipole. The magnetic moment is denoted as $ \vec{m} $ and represents the orientation of the magnet.\href{http://cdn1.askiitians.com/Images/201529-161356533-148-download.jpg}{link}}
\end{figure}

It can therefore be interpreted as the orientation of the bar magnet. The magnetic field strength $ \mathrm{B} $ of such a dipole source, located at the origin of the Cartesian coordinate frame, at position $ \vec{r} $ is defined as
\begin{equation} \label{eq:dipole}
\mathrm{B} = \frac{\mu_{0}}{4 \pi} \, \left (\frac{3 \vec{r} (\vec{r} \cdot \vec{r})\mathrm{R}}{|\vec{r}|^5} -
		\frac{\vec{m}}{|\vec{r}|^3} \right )
\end{equation}
with the constant $ \mu_{0} $, being the vacuum magnetic susceptibility \cite{camacho2013alternative}. This formula is valid independently of the shape and size of the magnetic body (current coil, permanent magnet, atom) if $ |r| $ is large enough \todo{how big exactly? I think it has to do with the relationship between magnetlength and so on...}. So roughly spoken the field strength $ \mathrm{B} \sim \frac{1}{|r|^ {3}}$.\\
Since this is a very general description for the behaviour of the magnetic field and does only hold for big vectors of $ \vec{r} $ (also verified in \todo{Reference to section verification, where I prove it!}), Camacho et al. \cite{camacho2013alternative} follow a more detailed way, taking the shape of the permanent cylindrical magnet into account. They assume that for a homogeneous, constantly magnetized body the distribution and orientation of magnetic dipoles inside a volume $ dV $ of this body is constant and have the magnetic dipole moment $ d\vec{m} = \vec{M}dV $. Where $ \vec{M} $ is the volume magnetization of the magnet. Further on it holds for a permanent magnet that the magnetization does not change for any external fields, they are supposed to be hard. Using this for the cylindrical bar magnet, which is assumed to be magnetized along its symmetry axis, the following can be applied: One cylindrical element $ dV $ is defined by the radius $ a $ and the height $ dz $. It is assumed that the bar magnet is aligned, such that the symmetry axis is oriented in $ z $ direction of the Cartesian coordinate system \ref{fig:cylMag}.
\begin{figure}
\centering
\includegraphics[width=0.25\textwidth]{pictures/cylMagCoSys.png}
\caption{A cylindrical magnet, aligned along its magnetization axis in $ z $ direction. A infinitesimal piece $ dz $ is sketched. The vector R to a dedicated measurement point is visualized \cite{derby2010cylindrical}.}
\label{fig:cylMag}
\end{figure}
The magnetic flux along the symmetry axis of such an infinitesimal element $ dV $ is given by \ref{eq:dipole}. In order to calculate $ \mathrm{B}_{z} $ for the whole magnet, one has to integrate these contributions over the entire volume. In the end one gets the following formula for the magnetic field of a bar magnet along its magnetization axis (for a detailed derivation, please have a look at \cite{camacho2013alternative}, \cite{derby2010cylindrical}):
\begin{equation} \label{eq:b_z}
\mathrm{B}_{z}(z) = \frac{\mathrm{B}_r}{2} \left ( \frac{z + b}{\sqrt{(z + b)^2 + a^2}} - \frac{z - b}{\sqrt{(z - b)^2 + a^2}} \right)
\end{equation}
The factor $ \mathrm{B}_r $ represents the Remanence field of the magnetic material. For the used neodymium magnet this value is in between 1.26-\SI{1.29}{\tesla}. In order to transform \ref{eq:b_z} into its electromagnetic equivalent, one just has to change $ \mathrm{B}_r $ to $ \frac{\mu_{0} n I}{2} $.\\
However there are several ways in deriving the mentioned equation. As shortly depicted, an integral over the whole surface has to be derived. Those integrals with a cylindrical symmetry are usually quite complex. However for the symmetrical case along the $ z $ axis, one can use some mathematical properties to ease and obtain the equation \ref{eq:b_z} in the end. However if one wants not only to describe the magnetic field along the magnetization axis, those properties and therefore the presented equation does not hold any more. Derby et al. propose to overcome this problem, by solving a complete elliptical integral \ac{CEL}. The generalized form of this is the following:
\begin{equation}\label{eq:cel}
C(k_{c},p,c,s) = \int_{0}^{\frac{\pi}{2}} \frac{c \, \cos^{2}\varphi + s \, \sin^{2}\varphi}
{(\cos^{2}\varphi + p \, \sin^{2}\varphi)\sqrt{\cos^{2}\varphi + k_{c}^{2} \, \sin^{2}\varphi}} \; d\varphi
\end{equation}
A cylindrical coordinate system is introduced, which makes sense, since one tries to describe a cylindrical shape. The corresponding structure and naming of axes is shown in \ref{fig:cylCoSys}. With the help of this cylindrical representation, the general magnetic field components can be expressed by
\begin{equation} \label{eq:cylB_rho}
\mathrm{B}_{\rho} = \mathrm{B}_{o}[\alpha_{+} C(k_{+},1,1,-1) \, - \, \alpha{-} C(k_{-},1,1,-1)]
\end{equation}
for the radial magnetic component along $ \rho $. And
\begin{equation} \label{eq:cylB_z}
\mathrm{B}_{z} = \frac{\mathrm{B}_{o}a}{a+\rho}[\beta_{+} C(k_{+},\gamma^2,1,\gamma) \, - \, \beta_{-} C(k_{-},\gamma^2,1,\gamma)]
\end{equation}
for the axial magnetic component along the $ z $ axis. Along with the following introduced variables, which are dependent on the cylindrical position $ (\rho, \varphi, z) $ of the dedicated point in space.
\begin{equation}
\mathrm{B}_{o} = \frac{\mu_{0}}{\pi}nI
\end{equation}

\begin{equation}
z_{\pm} = z_{\pm} b
\end{equation}

\begin{equation}
\alpha_{\pm} = \frac{a}{\sqrt{z_{\pm}^2+(\rho+a)^2}}
\end{equation}

\begin{equation}
\beta_{\pm} = \frac{z_{\pm}}{\sqrt{z_{\pm}^2+(\rho+a)^2}}
\end{equation}

\begin{equation}
\gamma = \frac{a-\rho}{a+\rho}
\end{equation}

\begin{equation}
k_{\pm} = \sqrt{\frac{z_{\pm}^2 + (a-\rho)^2}{z_{\pm}^2 + (a+\rho)^2}}
\end{equation}

The azimuthal component $ \varphi $ can be neglected, since the magnetic field does not change, by moving around a circle which is aligned perpendicular to the $ z $ axis. In order to derive the equation \ref{eq:b_z}, one just has to set the radial component $ \rho $ to 0 and $ z > b $\\
Those integrals are not easy to solve, therefore numerical methods are used to find a solution. However trying to find an exact solution with software like \textit{Mathematica} or \textit{Maple} failed \cite{camacho2013alternative}. Since \acp{CEL} are not only restricted to cylindrical bar magnets, there is some research going on in this field. For the used method, please look at \todo{reference to implementation}, for more about \ac{CEL} have a look at the bibliography of \cite{derby2010cylindrical}. Another method consists in using numerics, like \ac{FEM}. This can lead to satisfying results \cite{mladenovic2009magnetic}.

\begin{figure}
\centering
\includegraphics[width=0.5\textwidth]{pictures/cylCoSys2.png}
\label{fig:cylCoSys}
\caption{Representation of the cylindrical coordinate system frame. The height is denoted by the $ z $ axis, the radial component $ \rho $ is the euclidean distance from the $ z $ axis, the azimuth $ \varphi $ describes the angle between the reference direction and the chosen plane.}
\end{figure}


\todo{Remarks about model (this goes into the corresponding system design section...):}
\begin{itemize}
\item What you get from the cylindrical model is the B field for a sensor which is aligned exactly the same as your magnet, so always facing north. That's why you have to apply the rotation on the calculated B field. You therefore just want to translate it to your sensor coordinate frame.

\item The cylindrical position vector (z,rho) is dependent on the absolute distance vector (x,z) (from sensor to magnet center) in combination with the rotation (theta) of the magnet (in the easy case, just around y axis. And this is also the only rotation!)\\
$ (z,rho) = (x,z)*rot_{y}(theta) $

\item Apply the rotation of the magnet to your position vector (above) in order to get the right "division/split" into the two cylindric magnetic components(z and rho). Then take this field and apply the rotation of your sensor coordinate frame relative to the magnetic coordinate frame.\\
$ B_{sensor} = (B_{z},B_{rho})*rot_{y}(theta)^{-1} $\\
(not sure about the -1 neg.rotation, but I think so, because before applied it normally -> YES IT WORKS!)

\item Rotating the magnet around y axis represents flexion/extension(exactly what I want!).
A succeeding rotation about the x axis would represent aduction/abduction (what I want to neglect at first).
A succeeding rotation around z axis would represent rotation of the finger (what is not possible).
\end{itemize}
